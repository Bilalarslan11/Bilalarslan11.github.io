(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1],{1572:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/games",function(){return a(3468)}])},3468:(e,t,a)=>{"use strict";a.r(t),a.d(t,{__N_SSG:()=>i,default:()=>u});var r=a(7876),l=a(1411),s=a(596),n=a(3995),o=a(4107),c=a(4232),i=!0;let u=e=>{let{initialGames:t,initialError:a,builtAt:i}=e,[u,d]=(0,c.useState)(!1),h=()=>d(!1),[m]=(0,c.useState)(t),[g,p]=(0,c.useState)([]),[x,f]=(0,c.useState)(t),[v]=(0,c.useState)(null!=a?a:null),[w,y]=(0,c.useState)(!1);return(0,c.useEffect)(()=>{if(v)return;let e=!1;return(async()=>{try{y(!0);let t=await fetch("https://api.zehai.dk/api/games/top-rated",{cache:"no-store"});if(!t.ok)throw Error("live fetch ".concat(t.status));let a=await t.json(),r=a;if(!Array.isArray(r)){let e="object"==typeof a&&null!==a?a:null;r=Array.isArray(null==e?void 0:e.games)?e.games:[]}let l=r.map((e,t)=>{var a,r,l,s,n,o;let c="/gamepictures/placeholder.png";return(null==(a=e.cover)?void 0:a.url)&&(c=e.cover.url.startsWith("//")?"https:".concat(e.cover.url):e.cover.url),{id:null!=(r=e.id)?r:t+1,rank:t+1,title:null!=(l=e.name)?l:"Untitled",producer:"",hours:Math.round(null!=(s=e.rating)?s:0),image:c,rating:Number(null!=(o=null!=(n=e.weightedRating)?n:e.rating)?o:0),console:"",year:"",genre:"",company:"",credits:"",hundredPercent:"",dlc:""}});e||f(l)}catch(t){e||console.warn("Live update failed",t)}finally{e||y(!1)}})(),()=>{e=!0}},[v]),(0,c.useEffect)(()=>{try{let e=(0,o.Rq)();p(e)}catch(e){console.error("Error loading game statuses:",e)}},[]),(0,r.jsxs)(n.A,{nav:u,openNav:()=>d(!0),closeNav:h,scrollToSection:()=>h(),children:[v&&(0,r.jsx)("div",{className:"w-[90%] max-w-[112rem] mx-auto mb-6",role:"alert",children:(0,r.jsxs)("div",{className:"p-4 rounded border-2 border-theme-secondary bg-theme-darker",children:[(0,r.jsx)("p",{className:"text-theme-secondary font-bold mb-2",children:"Failed to load games"}),(0,r.jsx)("p",{className:"text-theme-text text-sm break-words mb-4",children:v}),(0,r.jsx)("p",{className:"text-theme-text text-xs opacity-70",children:"(Static build fetch failed)"})]})}),!v&&m.length>0&&(0,r.jsx)(l.A,{games:m,onFilterChange:e=>{f(e)}}),!v&&(0,r.jsx)(s.A,{games:x,gameStatuses:g,onStatusUpdate:()=>{try{let e=(0,o.Rq)();p(e)}catch(e){console.error("Error refreshing game statuses:",e)}},valueLabel:"/ 100"}),!v&&(0,r.jsx)("div",{className:"w-[90%] max-w-[112rem] mx-auto mt-4 text-right text-[10px] text-gray-400",children:(0,r.jsxs)("span",{children:["Built at ",new Date(i).toLocaleString()," \xb7 ",w?"Refreshingâ€¦":"Live order loaded"]})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[79,230,196,636,593,792],()=>t(1572)),_N_E=e.O()}]);