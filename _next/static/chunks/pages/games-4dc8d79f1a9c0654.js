(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1],{388:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var a=r(7876),n=r(1411),s=r(596),l=r(3995),o=r(4107);function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1920;if(!e||"string"!=typeof e||""===e.trim())return e||"";let r=e.startsWith("//")?"https:"+e:e;if(r.includes("images.igdb.com/igdb/image/upload/"))return r.replace("/t_thumb/","/t_cover_big/");try{let e=new URL(r);return e.searchParams.set("width",String(t)),e.searchParams.set("quality","90"),e.searchParams.set("dpr","2"),e.toString()}catch(a){let e=r.includes("?")?"&":"?";return"".concat(r).concat(e,"width=").concat(t,"&quality=90&dpr=2")}}var i=r(4232);let u=()=>{let[e,t]=(0,i.useState)(!1),r=()=>t(!1),[u,d]=(0,i.useState)([]),[m,h]=(0,i.useState)([]),[g,p]=(0,i.useState)([]),[f,y]=(0,i.useState)(null),[v,w]=(0,i.useState)("");return(0,i.useEffect)(()=>{try{let e=(0,o.Rq)();p(e)}catch(e){console.error("Error loading game statuses:",e)}},[]),(0,i.useEffect)(()=>{let e=!1;return(async()=>{try{let t=await fetch("https://api.zehai.dk/games/top-rated",{cache:"no-store",mode:"cors",credentials:"omit"});if(!t.ok)throw Error("API responded ".concat(t.status));let r=await t.json(),a=r;if(!Array.isArray(a)){let e="object"==typeof r&&null!==r?r:null;a=Array.isArray(null==e?void 0:e.games)?e.games:[]}let n=a.map((e,t)=>{var r,a,n,s,l;let o,i="/gamepictures/placeholder.png";if("string"==typeof e.cover?o=e.cover:e.cover&&"object"==typeof e.cover&&"url"in e.cover&&(o=e.cover.url),o&&""!==o.trim()){let e=c(o);e&&""!==e.trim()&&(i=e)}return{id:null!=(r=e.id)?r:t+1,rank:t+1,title:null!=(a=e.name)?a:"Untitled",producer:"",hours:Math.round(null!=(n=e.rating)?n:0),image:i,rating:Number(null!=(l=null!=(s=e.weightedRating)?s:e.rating)?l:0),console:"",year:"",genre:"",company:"",credits:"",hundredPercent:"",dlc:""}});e||(d(n),h(n),w(new Date().toISOString()),y(null))}catch(t){if(!e)try{let e=await fetch("/backupList.json",{cache:"no-store"});if(!e.ok)throw Error("Backup responded ".concat(e.status));let t=await e.json(),r=(Array.isArray(t)?t:Array.isArray(null==t?void 0:t.games)?t.games:[]).map((e,t)=>{var r,a,n,s,l;let o,i="/gamepictures/placeholder.png";if("string"==typeof e.cover?o=e.cover:e.cover&&"object"==typeof e.cover&&"url"in e.cover&&(o=e.cover.url),o&&""!==o.trim()){let e=c(o);e&&""!==e.trim()&&(i=e)}return{id:null!=(r=e.id)?r:t+1,rank:t+1,title:null!=(a=e.name)?a:"Untitled",producer:"",hours:Math.round(null!=(n=e.rating)?n:0),image:i,rating:Number(null!=(l=null!=(s=e.weightedRating)?s:e.rating)?l:0),console:"",year:"",genre:"",company:"",credits:"",hundredPercent:"",dlc:""}});d(r),h(r),w(new Date().toISOString()),y(null)}catch(e){y(t instanceof Error?t.message:String(t)),d([]),h([]),w(new Date().toISOString())}}})(),()=>{e=!0}},[]),(0,a.jsxs)(l.A,{nav:e,openNav:()=>t(!0),closeNav:r,scrollToSection:()=>r(),children:[f&&(0,a.jsx)("div",{className:"w-[90%] max-w-[112rem] mx-auto mb-6",role:"alert",children:(0,a.jsxs)("div",{className:"p-4 rounded border-2 border-theme-secondary bg-theme-darker",children:[(0,a.jsx)("p",{className:"text-theme-secondary font-bold mb-2",children:"Failed to load games"}),(0,a.jsx)("p",{className:"text-theme-text text-sm break-words mb-4",children:f}),(0,a.jsx)("p",{className:"text-theme-text text-xs opacity-70",children:"(Static build fetch failed)"})]})}),!f&&u.length>0&&(0,a.jsx)(n.A,{games:u,onFilterChange:e=>{h(e)}}),!f&&(0,a.jsx)(s.A,{games:m,gameStatuses:g,onStatusUpdate:()=>{try{let e=(0,o.Rq)();p(e)}catch(e){console.error("Error refreshing game statuses:",e)}},valueLabel:"/ 100",showStatusButton:!0}),!f&&(0,a.jsx)("div",{className:"w-[90%] max-w-[112rem] mx-auto mt-4 text-right text-[10px] text-gray-400",children:(0,a.jsxs)("span",{children:["Fetched at ",new Date(v).toLocaleString()]})})]})}},1572:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/games",function(){return r(388)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[79,230,196,636,593,792],()=>t(1572)),_N_E=e.O()}]);