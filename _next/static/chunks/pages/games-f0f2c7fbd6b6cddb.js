(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1],{388:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var a=r(7876),s=r(1411),n=r(596),l=r(3995),c=r(4107),o=r(4232);let i=()=>{let[e,t]=(0,o.useState)(!1),r=()=>t(!1),[i,d]=(0,o.useState)([]),[u,m]=(0,o.useState)([]),[h,g]=(0,o.useState)([]),[p,x]=(0,o.useState)(null),[f,w]=(0,o.useState)("");return(0,o.useEffect)(()=>{try{let e=(0,c.Rq)();g(e)}catch(e){console.error("Error loading game statuses:",e)}},[]),(0,o.useEffect)(()=>{let e=!1;return(async()=>{try{let t=await fetch("https://api.zehai.dk/games/top-rated",{cache:"no-store",mode:"cors",credentials:"omit"});if(!t.ok)throw Error("API responded ".concat(t.status));let r=await t.json(),a=r;if(!Array.isArray(a)){let e="object"==typeof r&&null!==r?r:null;a=Array.isArray(null==e?void 0:e.games)?e.games:[]}let s=a.map((e,t)=>{var r,a,s,n,l;let c,o="/gamepictures/placeholder.png";if("string"==typeof e.cover?c=e.cover:e.cover&&"object"==typeof e.cover&&"url"in e.cover&&(c=e.cover.url),c&&""!==c.trim()){let e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1920;if(!e||"string"!=typeof e||""===e.trim())return e||"";let r=e.startsWith("//")?"https:"+e:e;if(r.includes("images.igdb.com/igdb/image/upload/"))return r.replace("/t_thumb/","/t_cover_big/");try{let e=new URL(r);return e.searchParams.set("width",String(t)),e.searchParams.set("quality","90"),e.searchParams.set("dpr","2"),e.toString()}catch(a){let e=r.includes("?")?"&":"?";return"".concat(r).concat(e,"width=").concat(t,"&quality=90&dpr=2")}}(c);e&&""!==e.trim()&&(o=e)}return{id:null!=(r=e.id)?r:t+1,rank:t+1,title:null!=(a=e.name)?a:"Untitled",producer:"",hours:Math.round(null!=(s=e.rating)?s:0),image:o,rating:Number(null!=(l=null!=(n=e.weightedRating)?n:e.rating)?l:0),console:"",year:"",genre:"",company:"",credits:"",hundredPercent:"",dlc:""}});e||(d(s),m(s),w(new Date().toISOString()),x(null))}catch(t){e||(x(t instanceof Error?t.message:String(t)),d([]),m([]),w(new Date().toISOString()))}})(),()=>{e=!0}},[]),(0,a.jsxs)(l.A,{nav:e,openNav:()=>t(!0),closeNav:r,scrollToSection:()=>r(),children:[p&&(0,a.jsx)("div",{className:"w-[90%] max-w-[112rem] mx-auto mb-6",role:"alert",children:(0,a.jsxs)("div",{className:"p-4 rounded border-2 border-theme-secondary bg-theme-darker",children:[(0,a.jsx)("p",{className:"text-theme-secondary font-bold mb-2",children:"Failed to load games"}),(0,a.jsx)("p",{className:"text-theme-text text-sm break-words mb-4",children:p}),(0,a.jsx)("p",{className:"text-theme-text text-xs opacity-70",children:"(Static build fetch failed)"})]})}),!p&&i.length>0&&(0,a.jsx)(s.A,{games:i,onFilterChange:e=>{m(e)}}),!p&&(0,a.jsx)(n.A,{games:u,gameStatuses:h,onStatusUpdate:()=>{try{let e=(0,c.Rq)();g(e)}catch(e){console.error("Error refreshing game statuses:",e)}},valueLabel:"/ 100"}),!p&&(0,a.jsx)("div",{className:"w-[90%] max-w-[112rem] mx-auto mt-4 text-right text-[10px] text-gray-400",children:(0,a.jsxs)("span",{children:["Fetched at ",new Date(f).toLocaleString()]})})]})}},1572:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/games",function(){return r(388)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[79,230,196,636,593,792],()=>t(1572)),_N_E=e.O()}]);