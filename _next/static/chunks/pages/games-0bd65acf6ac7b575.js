(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1],{388:(e,t,a)=>{"use strict";a.r(t),a.d(t,{__N_SSG:()=>o,default:()=>u});var r=a(7876),s=a(1411),l=a(596),n=a(3995),i=a(4107),c=a(4232),o=!0;let u=e=>{let{initialGames:t,initialError:a,builtAt:o}=e,[u,d]=(0,c.useState)(!1),h=()=>d(!1),[m]=(0,c.useState)(t),[g,p]=(0,c.useState)([]),[x,f]=(0,c.useState)(t),[w]=(0,c.useState)(null!=a?a:null),[v,y]=(0,c.useState)(!1);return(0,c.useEffect)(()=>{if(w)return;let e=!1;return(async()=>{try{y(!0);let t=await fetch("https://api.zehai.dk/api/games/top-rated",{cache:"no-store"});if(!t.ok)throw Error("live fetch ".concat(t.status));let a=await t.json(),r=a;if(!Array.isArray(r)){let e="object"==typeof a&&null!==a?a:null;r=Array.isArray(null==e?void 0:e.games)?e.games:[]}let s=r.map((e,t)=>{var a,r,s,l,n,i;let c="/gamepictures/placeholder.png";return(null==(a=e.cover)?void 0:a.url)&&(c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1920;if(!e)return e;let a=e.startsWith("//")?"https:"+e:e;if(a.includes("images.igdb.com/igdb/image/upload/"))return a.replace("/t_thumb/","/t_cover_big/");try{let e=new URL(a);return e.searchParams.set("width",String(t)),e.searchParams.set("quality","90"),e.searchParams.set("dpr","2"),e.toString()}catch(r){let e=a.includes("?")?"&":"?";return"".concat(a).concat(e,"width=").concat(t,"&quality=90&dpr=2")}}(e.cover.url)),{id:null!=(r=e.id)?r:t+1,rank:t+1,title:null!=(s=e.name)?s:"Untitled",producer:"",hours:Math.round(null!=(l=e.rating)?l:0),image:c,rating:Number(null!=(i=null!=(n=e.weightedRating)?n:e.rating)?i:0),console:"",year:"",genre:"",company:"",credits:"",hundredPercent:"",dlc:""}});e||f(s)}catch(t){e||console.warn("Live update failed",t)}finally{e||y(!1)}})(),()=>{e=!0}},[w]),(0,c.useEffect)(()=>{try{let e=(0,i.Rq)();p(e)}catch(e){console.error("Error loading game statuses:",e)}},[]),(0,r.jsxs)(n.A,{nav:u,openNav:()=>d(!0),closeNav:h,scrollToSection:()=>h(),children:[w&&(0,r.jsx)("div",{className:"w-[90%] max-w-[112rem] mx-auto mb-6",role:"alert",children:(0,r.jsxs)("div",{className:"p-4 rounded border-2 border-theme-secondary bg-theme-darker",children:[(0,r.jsx)("p",{className:"text-theme-secondary font-bold mb-2",children:"Failed to load games"}),(0,r.jsx)("p",{className:"text-theme-text text-sm break-words mb-4",children:w}),(0,r.jsx)("p",{className:"text-theme-text text-xs opacity-70",children:"(Static build fetch failed)"})]})}),!w&&m.length>0&&(0,r.jsx)(s.A,{games:m,onFilterChange:e=>{f(e)}}),!w&&(0,r.jsx)(l.A,{games:x,gameStatuses:g,onStatusUpdate:()=>{try{let e=(0,i.Rq)();p(e)}catch(e){console.error("Error refreshing game statuses:",e)}},valueLabel:"/ 100"}),!w&&(0,r.jsx)("div",{className:"w-[90%] max-w-[112rem] mx-auto mt-4 text-right text-[10px] text-gray-400",children:(0,r.jsxs)("span",{children:["Built at ",new Date(o).toLocaleString()," \xb7"," ",v?"Refreshingâ€¦":"Live order loaded"]})})]})}},1572:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/games",function(){return a(388)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[79,230,196,636,593,792],()=>t(1572)),_N_E=e.O()}]);